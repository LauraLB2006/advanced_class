<html>
<head>
<meta charset="utf-8">
  <meta name="viewport" content="initial-scale=1,maximum-scale=1,user-scalable=no">
  <title>Colleges and Universities in the Greater St. Louis Area</title>

<link rel="stylesheet" href="https://unpkg.com/leaflet@1.3.3/dist/leaflet.css"
   integrity="sha512-Rksm5RenBEKSKFjgI3a41vrjkw4EVPlJ3+OiI65vTjIdo9brlAacEuKOiQ5OFh7cOI1bkDwLqdLw3Zg0cRJAAQ=="
   crossorigin=""/>
  
<!-- Make sure you put this AFTER Leaflet's CSS -->
<script src="https://unpkg.com/leaflet@1.3.3/dist/leaflet.js"
   integrity="sha512-tAGcCfR4Sc5ZP5ZoVz0quoZDYX5aCtEm/eu1KhSLj2c9eFrylXZknQYmxUssFaVJKvvc0dJQixhGjG2yXWiV9Q=="
   crossorigin=""></script>

<style>
    #mapid{ height: 100% }
    html,
    body,
    #viewDiv {
      padding: 0;
      margin: 0;
      height: 100%;
      width: 100%;
    }
</style>

<script>
  require([
      "esri/Map",
      "esri/layers/CSVLayer",
      "esri/views/MapView",
      "esri/layers/FeatureLayer",
      "esri/config",
      "esri/core/urlUtils",
      "dojo/domReady!"
    ], 
    function(
      Map,
      CSVLayer,
      MapView,
      FeatureLayer,
      esriConfig,
      urlUtils
    ){
    
  var mymap = L.map('mapid').setView([38.6270, -90.1994], 13);
    L.tileLayer('http://a.tile.stamen.com/toner/{z}/{x}/{y}.png', {
        attribution: 'Map tiles by Stamen Design, under CC BY 3.0.',
        maxZoom: 18,
        id: 'mapbox.streets'
   }).addTo(mymap);
     
  var circle = L.circle([38.6270, -90.1994], {
    color: 'green',
    fillColor: '#0099aa',
    fillOpacity: 0.5,
    radius: 45000
  }).addTo(mymap);
    
  var polygon = L.polygon([
    [38.643853, -90.265392],
    [38.646953, -90.300508],
    [38.633442, -90.303936],
    [38.629042, -90.264864]
  ],
  {
  fillColor:'green',
   color:'green'
  }).addTo(mymap);
    
  var marker1 = L.marker([38.637029,-90.2328157]).addTo(mymap);
  var marker2 = L.marker([38.6350254,-90.2261752]).addTo(mymap);
  
  marker1.bindPopup("<b>Great Pizza at Vito's</b><br>");
  marker2.bindPopup("<b>Great BBQ at Pappy's</b><br>");
  circle.bindPopup("This is the Greater St. Louis area.");
  polygon.bindPopup("This is Forest Park.");
    
  var popup = L.popup();
  function onMapClick(e) {
      popup
          .setLatLng(e.latlng)
          .setContent("You clicked the map at " + e.latlng.toString())
          .openOn(mymap);
  }
  mymap.on('click', onMapClick);
  
  var url = "https://raw.githubusercontent.com/LauraLB2006/advanced_class/master/Project1/Colleges%20in%20Greater%20STL.csv";
      esriConfig.request.corsEnabledServers.push(url);
      };
          
  var template = {
        title: "Greater St. Louis Colleges and Universities",
        content: "{Sch_Name} is in category {Category} and located at {Address}."
      };
    
  var csvLayer = new CSVLayer({
        url: url,
        copyright: "Laura Bernett 2018",
        popupTemplate: template,
        
      });
      csvLayer.renderer = {
       type: "simple", // autocasts as new SimpleRenderer()
       symbol: symbol
      };
  
  //add metrolink feature layer
  const featureLayer1 = new FeatureLayer({
          url: "https://services2.arcgis.com/yL7v93RXrxlqkeDx/arcgis/rest/services/MetroLinkLocations/FeatureServer/0"
        });
        map.add(featureLayer1);
    
  //add bike trails feature layer  
  const featureLayer2 = new FeatureLayer({
          url: "https://services1.arcgis.com/g2TonOxuRkIqSOFx/arcgis/rest/services/GreatRiversGreenway2016/FeatureServer/0"
        });
        map.add(featureLayer2);
    
  //add STL attractions feature layer
  const featureLayer3 = new FeatureLayer({
          url: "https://services1.arcgis.com/0MSEUqKaxRlEPj5g/arcgis/rest/services/STL_Attraction/FeatureServer/0"
        });
        map.add(featureLayer3);
  
  //add STL250 cakes feature layer
   const featureLayer4 = new FeatureLayer({
          url: "https://services1.arcgis.com/0MSEUqKaxRlEPj5g/arcgis/rest/services/stl250Locations/FeatureServer/0"
        });
        map.add(featureLayer4);
   
  //add STL neighborhoods feature layer
    const featureLayer5 = new FeatureLayer({
          url: "https://services.arcgis.com/Ak4vS4r1vIYUiU3q/arcgis/rest/services/StLNeighborhoods/FeatureServer/0"
        });
        map.add(featureLayer5);
    
</script>
</head>
<body>
<div id="mapid"></div>
</body>
</html>
